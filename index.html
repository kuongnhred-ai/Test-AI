<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Video Creator - Real Gemini AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes kenburns { 0% { transform: scale(1); } 100% { transform: scale(1.15); } }
        .animate-kenburns { animation: kenburns 12s linear infinite alternate; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script>
        const { useState, useRef, useEffect, createElement: h } = React;

        // LÆ¯U Ã: Äá»ƒ API key tháº­t á»Ÿ Ä‘Ã¢y sáº½ an toÃ n hÆ¡n localhost
        const YOUR_GEMINI_KEY = "AIzaSyBgFJkH5n7pLm5O6N7P8Q9R0S1T2U3V4W5";

        const TRACKS = [
            { id: 'upbeat', name: 'ðŸ”¥ Nháº¡c NÄƒng Äá»™ng', url: 'https://assets.mixkit.co/music/preview/mixkit-tech-house-vibes-130.mp3' },
            { id: 'chill', name: 'â˜ï¸ Nháº¡c Chill Lofi', url: 'https://assets.mixkit.co/music/preview/mixkit-chill-hop-01-225.mp3' },
            { id: 'epic', name: 'ðŸŽ» Nháº¡c HÃ¹ng TrÃ¡ng', url: 'https://assets.mixkit.co/music/preview/mixkit-epic-cinematic-trailer-292.mp3' }
        ];

        function App() {
            const [step, setStep] = useState(1);
            const [data, setData] = useState({ 
                goal: 'viral', 
                style: 'dynamic', 
                duration: 30, 
                selectedTrack: TRACKS[0], 
                files: [], 
                text: '' 
            });
            const [playing, setPlaying] = useState(false);
            const [aiLoading, setAiLoading] = useState(false);
            const [apiStatus, setApiStatus] = useState('');
            
            const audioRef = useRef(null);
            const fileRef = useRef(null);

            useEffect(() => {
                if (step === 4 && playing) {
                    if (audioRef.current) audioRef.current.pause();
                    audioRef.current = new Audio(data.selectedTrack.url);
                    audioRef.current.loop = true;
                    audioRef.current.play().catch(e => console.error("Lá»—i nháº¡c:", e));
                } else if (audioRef.current) {
                    audioRef.current.pause();
                }
            }, [playing, step, data.selectedTrack]);

            // HÃ€M Gá»ŒI GOOGLE GEMINI AI
            const callAiApi = async () => {
                setAiLoading(true);
                setApiStatus('Äang káº¿t ná»‘i vá»›i Google Gemini AI...');
                
                try {
                    const promptText = `HÃ£y viáº¿t má»™t Ä‘oáº¡n ká»‹ch báº£n ngáº¯n (khoáº£ng 30 tá»«) Ä‘á»ƒ lÃ m video TikTok. 
                                      Má»¥c tiÃªu video: ${data.goal}. Phong cÃ¡ch: ${data.style}. 
                                      YÃªu cáº§u: Thu hÃºt, cÃ³ lá»i kÃªu gá»i hÃ nh Ä‘á»™ng, ngÃ´n ngá»¯ tiáº¿ng Viá»‡t tráº» trung.`;

                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${YOUR_GEMINI_KEY}`,
                        {
                            method: 'POST',
                            headers: { 
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                contents: [{ 
                                    parts: [{ 
                                        text: promptText 
                                    }] 
                                }]
                            })
                        }
                    );

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const json = await response.json();
                    
                    if (json.error) {
                        throw new Error(json.error.message);
                    }

                    const aiResult = json.candidates?.[0]?.content?.parts?.[0]?.text || 
                                   "AI Ä‘Ã£ pháº£n há»“i nhÆ°ng khÃ´ng cÃ³ ná»™i dung.";
                    
                    setData({...data, text: aiResult});
                    setApiStatus('âœ… Káº¿t ná»‘i thÃ nh cÃ´ng vá»›i Google Gemini!');

                } catch (error) {
                    console.error("Lá»—i Gemini API:", error);
                    setApiStatus(`âŒ Lá»—i: ${error.message}`);
                    
                    // Fallback: Dá»¯ liá»‡u máº«u náº¿u API fail
                    const fallbackText = {
                        viral: "ðŸ”¥ Báº N Sáº¼ Báº¤T NGá»œ! Xu hÆ°á»›ng má»›i nháº¥t 2024 Ä‘Ã£ cÃ³ á»Ÿ Ä‘Ã¢y! Like & Share ngay náº¿u tháº¥y hay!",
                        product: "ðŸ›ï¸ Sáº¢N PHáº¨M Äá»˜C QUYá»€N! Chá»‰ cÃ²n 50 suáº¥t Æ°u Ä‘Ã£i. Mua ngay trong link bio!",
                    }[data.goal] || "Táº¡o ná»™i dung háº¥p dáº«n cho video cá»§a báº¡n!";
                    
                    setData({...data, text: fallbackText});
                } finally {
                    setAiLoading(false);
                }
            };

            const renderContent = () => {
                // ... (giá»¯ nguyÃªn cÃ¡c pháº§n render khÃ¡c)
                // Code render giá»¯ nguyÃªn nhÆ° báº¡n Ä‘Ã£ cÃ³
                
                if (step === 1) return h('div', { className: 'space-y-4' }, [
                    {id:'viral', n:'Viral Trending', e:'ðŸ”¥'}, 
                    {id:'product', n:'BÃ¡n sáº£n pháº©m', e:'ðŸ›ï¸'}
                ].map(g => h('button', {
                    key: g.id, 
                    onClick: () => setData({...data, goal: g.id}),
                    className: `w-full p-8 rounded-3xl border-4 flex items-center gap-8 transition-all ${
                        data.goal === g.id ? 'border-orange-500 bg-orange-50 scale-[1.02]' : 'bg-white hover:bg-gray-50'
                    }`
                }, [
                    h('span', {className:'text-6xl'}, g.e), 
                    h('span', {className:'text-2xl font-black'}, g.n)
                ])));

                if (step === 2) return h('div', { className: 'space-y-4' }, [
                    {id:'dynamic', n:'NÄƒng Ä‘á»™ng', e:'âš¡'}, 
                    {id:'pro', n:'ChuyÃªn nghiá»‡p', e:'ðŸ’¼'}
                ].map(s => h('button', { 
                    key: s.id, 
                    onClick: () => setData({...data, style: s.id}), 
                    className: `w-full p-8 rounded-3xl border-4 flex items-center gap-8 transition-all ${
                        data.style === s.id ? 'border-blue-600 bg-blue-50 scale-[1.02]' : 'bg-white hover:bg-gray-50'
                    }` 
                }, [
                    h('span', {className:'text-6xl'}, s.e), 
                    h('span', {className:'text-2xl font-black'}, s.n)
                ])));

                if (step === 3) return h('div', { className: 'space-y-6' }, [
                    h('div', { className: 'bg-white p-6 rounded-3xl border-2 shadow-sm' }, [
                        h('label', { className: 'block font-black text-xl mb-4 text-gray-700' }, 'ðŸ“¸ Táº£i lÃªn hÃ¬nh áº£nh/video'),
                        h('div', { className: 'flex items-center gap-4' }, [
                            h('button', { 
                                onClick: () => fileRef.current.click(), 
                                className: 'w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 text-white text-4xl rounded-2xl hover:opacity-90 transition-all active:scale-95' 
                            }, '+'),
                            h('span', { className: 'text-gray-600' }, data.files.length > 0 ? 'âœ… ÄÃ£ táº£i lÃªn 1 file' : 'Chá»n file tá»« mÃ¡y tÃ­nh')
                        ]),
                        h('input', { 
                            type: 'file', 
                            ref: fileRef, 
                            className: 'hidden', 
                            accept: 'image/*,video/*',
                            onChange: (e) => {
                                if (e.target.files[0]) {
                                    setData({
                                        ...data, 
                                        files: [{
                                            url: URL.createObjectURL(e.target.files[0]),
                                            name: e.target.files[0].name
                                        }]
                                    });
                                }
                            }
                        })
                    ]),
                    
                    h('div', { className: 'bg-gradient-to-r from-indigo-600 to-purple-600 p-8 rounded-[3rem] shadow-2xl text-white' }, [
                        h('label', { className: 'block font-black text-xl mb-4' }, 'ðŸ§  SÃ¡ng táº¡o ká»‹ch báº£n vá»›i Google Gemini AI'),
                        
                        h('div', { className: 'mb-4 p-3 bg-white/10 rounded-xl' }, [
                            h('span', { className: 'text-sm opacity-90' }, 'Tráº¡ng thÃ¡i API: '),
                            h('span', { className: 'font-bold' }, apiStatus || 'ChÆ°a káº¿t ná»‘i')
                        ]),
                        
                        h('textarea', { 
                            value: data.text, 
                            onChange: e => setData({...data, text: e.target.value}), 
                            className: 'w-full p-5 rounded-2xl mb-4 h-40 font-bold text-gray-800 text-lg placeholder-gray-400', 
                            placeholder: 'Ká»‹ch báº£n AI sáº½ xuáº¥t hiá»‡n táº¡i Ä‘Ã¢y...\nVÃ­ dá»¥: "ðŸ”¥ XU HÆ¯á»šNG Má»šI NHáº¤T! Cáº­p nháº­t ngay trong 30s. Like & Share náº¿u tháº¥y há»¯u Ã­ch!"' 
                        }),
                        
                        h('button', { 
                            onClick: callAiApi, 
                            disabled: aiLoading,
                            className: `w-full py-5 bg-white text-indigo-700 font-black rounded-2xl text-xl shadow-lg transition-all flex items-center justify-center gap-3 ${
                                aiLoading ? 'opacity-80 cursor-not-allowed' : 'hover:bg-gray-100 active:scale-95'
                            }` 
                        }, [
                            aiLoading ? h('span', {className: 'animate-spin'}, 'â³') : h('span', {}, 'âœ¨'),
                            aiLoading ? 'AI ÄANG Xá»¬ LÃ...' : 'VIáº¾T Ká»ŠCH Báº¢N Báº°NG AI'
                        ]),
                        
                        h('p', { className: 'mt-4 text-sm opacity-80 text-center' }, 
                            'Sá»­ dá»¥ng Google Gemini AI tháº­t - hoáº¡t Ä‘á»™ng trÃªn GitHub Pages'
                        )
                    ])
                ]);

                if (step === 4) return h('div', { className: 'flex flex-col items-center' }, [
                    h('h3', { className: 'text-2xl font-black mb-6 text-gray-800' }, 'ðŸ‘ï¸ Xem trÆ°á»›c video'),
                    
                    h('div', { className: 'relative w-[300px] aspect-[9/16] bg-black rounded-[3.5rem] border-[14px] border-slate-900 overflow-hidden shadow-2xl' }, [
                        data.files.length > 0 
                            ? h('img', { 
                                src: data.files[0].url, 
                                className: `w-full h-full object-cover ${playing ? 'animate-kenburns' : ''}`,
                                alt: 'Preview' 
                              }) 
                            : h('div', { className: 'w-full h-full bg-gradient-to-br from-slate-800 to-gray-900 flex items-center justify-center' }, 
                                h('span', { className: 'text-white text-lg' }, 'ðŸŽ¬ ChÆ°a cÃ³ hÃ¬nh áº£nh')
                              ),
                        
                        h('div', { 
                            className: `absolute bottom-12 inset-x-4 p-5 bg-black/70 backdrop-blur-md rounded-2xl text-white text-center transition-all duration-300 ${
                                playing && data.text ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'
                            }` 
                        }, 
                            data.text || 'Ná»™i dung video sáº½ hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y'
                        ),
                        
                        !playing && h('button', { 
                            onClick: () => setPlaying(true), 
                            className: 'absolute inset-0 m-auto w-24 h-24 bg-gradient-to-r from-blue-500/30 to-purple-500/30 rounded-full text-white text-5xl flex items-center justify-center border-2 border-white/30 backdrop-blur-sm hover:scale-110 transition-all' 
                        }, 'â–¶ï¸'),
                        
                        playing && h('button', { 
                            onClick: () => setPlaying(false), 
                            className: 'absolute top-6 right-6 w-12 h-12 bg-red-500/80 text-white rounded-full flex items-center justify-center text-xl backdrop-blur-sm' 
                        }, 'â¸ï¸')
                    ]),
                    
                    h('div', { className: 'mt-8 w-full max-w-md' }, [
                        h('p', { className: 'font-black text-gray-600 uppercase tracking-widest mb-4 text-center' }, 
                            `ðŸ”Š ${data.selectedTrack.name}`
                        ),
                        
                        h('div', { className: 'flex gap-3 justify-center' }, 
                            TRACKS.map(track => 
                                h('button', {
                                    key: track.id,
                                    onClick: () => setData({...data, selectedTrack: track}),
                                    className: `px-4 py-2 rounded-full font-bold transition-all ${
                                        data.selectedTrack.id === track.id 
                                            ? 'bg-gray-900 text-white' 
                                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                    }`
                                }, track.name.split(' ')[0])
                            )
                        )
                    ])
                ]);

                if (step === 5) return h('div', { className: 'text-center py-20' }, [
                    h('span', { className: 'text-9xl block mb-6 animate-bounce' }, 'ðŸš€'),
                    h('h2', { className: 'text-4xl font-black mb-8 text-gray-800' }, 'HOÃ€N Táº¤T!'),
                    h('p', { className: 'text-gray-600 mb-10 text-lg' }, 'Video cá»§a báº¡n Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ xuáº¥t báº£n'),
                    h('button', { 
                        className: 'w-full max-w-md mx-auto py-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-3xl font-black text-2xl shadow-2xl hover:opacity-90 transition-all active:scale-95' 
                    }, 'ðŸ’¾ Táº¢I XUá»NG MP4'),
                    h('button', { 
                        onClick: () => {
                            setStep(1);
                            setData({ goal: 'viral', style: 'dynamic', duration: 30, selectedTrack: TRACKS[0], files: [], text: '' });
                            setPlaying(false);
                        },
                        className: 'mt-6 text-gray-500 hover:text-gray-700 font-bold' 
                    }, 'ðŸ”„ Táº¡o video má»›i')
                ]);
            };

            return h('div', { className: 'max-w-2xl mx-auto p-4 md:p-10' }, [
                // Header vá»›i cÃ¡c bÆ°á»›c
                h('header', { className: 'mb-12 mt-4' }, [
                    h('h1', { className: 'text-3xl font-black text-center mb-8 text-gray-800' }, 'ðŸŽ¬ AI Video Creator'),
                    h('div', { className: 'flex justify-between items-center relative' }, [
                        // ÄÆ°á»ng line ná»‘i cÃ¡c bÆ°á»›c
                        h('div', { className: 'absolute top-8 left-16 right-16 h-2 bg-gray-200 -z-10' }),
                        [1, 2, 3, 4, 5].map(i => 
                            h('div', { key: i, className: 'flex flex-col items-center' }, [
                                h('div', { 
                                    className: `w-16 h-16 rounded-full flex items-center justify-center text-3xl shadow-xl transition-all duration-300 ${
                                        step >= i 
                                            ? 'bg-gradient-to-r from-orange-500 to-pink-500 text-white scale-110 shadow-orange-200' 
                                            : 'bg-white text-gray-300'
                                    }`
                                }, 
                                    i === 1 ? 'ðŸŽ¯' : 
                                    i === 2 ? 'ðŸŽ¬' : 
                                    i === 3 ? 'âš™ï¸' : 
                                    i === 4 ? 'ðŸ‘ï¸' : 'ðŸš€'
                                ),
                                h('span', { 
                                    className: `mt-2 font-bold text-sm ${
                                        step >= i ? 'text-gray-800' : 'text-gray-400'
                                    }`
                                }, 
                                    i === 1 ? 'Má»¥c tiÃªu' : 
                                    i === 2 ? 'Phong cÃ¡ch' : 
                                    i === 3 ? 'Ná»™i dung' : 
                                    i === 4 ? 'Xem trÆ°á»›c' : 'HoÃ n táº¥t'
                                )
                            ])
                        )
                    ])
                ]),
                
                // Main content
                h('main', { className: 'bg-white rounded-[4rem] shadow-2xl p-8 md:p-10 min-h-[600px] flex flex-col border-4 border-white mb-10' }, [
                    h('div', { className: 'flex-1' }, renderContent()),
                    
                    // Navigation buttons
                    step < 5 && h('div', { className: 'flex gap-6 mt-10' }, [
                        h('button', { 
                            onClick: () => {
                                setStep(step - 1);
                                setPlaying(false);
                            }, 
                            disabled: step === 1, 
                            className: `flex-1 py-6 font-black text-xl rounded-3xl transition-all ${
                                step === 1 
                                    ? 'bg-gray-100 text-gray-300 cursor-not-allowed' 
                                    : 'bg-gray-200 text-gray-600 hover:bg-gray-300 active:scale-95'
                            }`
                        }, 'â† QUAY Láº I'),
                        
                        h('button', { 
                            onClick: () => {
                                setStep(step + 1);
                                setPlaying(false);
                            }, 
                            className: 'flex-[2] py-6 bg-gradient-to-r from-gray-900 to-black text-white rounded-3xl font-black text-2xl shadow-xl hover:opacity-90 active:scale-95 transition-all flex items-center justify-center gap-2' 
                        }, [
                            step === 4 ? 'HOÃ€N THÃ€NH' : 'TIáº¾P THEO',
                            h('span', {}, 'â†’')
                        ])
                    ])
                ]),
                
                // Footer
                h('footer', { className: 'text-center text-gray-500 text-sm mt-8 pb-4' }, [
                    h('p', {}, 'Powered by Google Gemini AI â€¢ '),
                    h('a', { 
                        href: 'https://github.com/yourusername/ai-video-creator', 
                        target: '_blank',
                        className: 'text-blue-500 hover:underline'
                    }, 'Xem trÃªn GitHub')
                ])
            ]);
        }

        ReactDOM.createRoot(document.getElementById('root')).render(h(App));
    </script>
</body>
</html>
